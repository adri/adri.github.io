{"componentChunkName":"component---plugins-gatsby-theme-brain-src-templates-brain-js","path":"/notes/use-the-terraform-eks-module-without-kubernetes-access","result":{"data":{"brainNote":{"slug":"use-the-terraform-eks-module-without-kubernetes-access","title":"Use the Terraform EKS module without Kubernetes access","inboundReferenceNotes":[{"title":"Site Reliability Engineering","slug":"site-reliability-engineering"}],"inboundReferences":["site-reliability-engineering"],"childMdx":{"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"When using the Terraform EKS module to manage a AWS EKS cluster, it needs access to the Kubernetes API. When running on Terraform Cloud, unfortunately there is no static IP address that can be used to restrict the Kubernetes APIs public access.\"), mdx(\"p\", null, \"Unless you host your own Terraform workers in your own VPC, access to the Kubernetes API is needed.\"), mdx(\"h3\", null, \"Manage Resources that need API access yourself\"), mdx(\"p\", null, \"Actually the only reason why Kubernetes API access is needed, is that Terraform manages the ConfigMap \\\"aws_auth\\\".\"), mdx(\"p\", null, \"This configuration file can be managed by yourself instead. These settings can be used on the EKS module to avoid Terraform connecting to the Kubernetes API:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"// Avoid Terraform connecting to the Kubernetes cluster API.\\n// Because Terraform workers don't run in our VPC, we would need to make our cluster accessible publicly.\\nmanage_aws_auth  = \\\"false\\\"\\nwrite_kubeconfig = \\\"false\\\"\\n\")), mdx(\"p\", null, \"To not actually delete the ConfigMap, the ConfigMap key can be manually deleted:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {}), \"terraform state rm 'module.cluster-name.kubernetes_config_map.aws_auth[0]'\\n\")), mdx(\"p\", null, \"See \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"/notes/delete-key-from-terraform-cloud-state\"\n  }), \"Delete key from Terraform Cloud state\"), \".\"), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"/notes/published\"\n  }), \"#published\"), \" \"));\n}\n;\nMDXContent.isMDXComponent = true;","excerpt":"When using the Terraform EKS module to manage a AWS EKS cluster, it needs access to the Kubernetes API. When running on Terraform Cloudâ€¦"}}},"pageContext":{"slug":"use-the-terraform-eks-module-without-kubernetes-access"}},"staticQueryHashes":["318001574","3787687951","3787687951"]}