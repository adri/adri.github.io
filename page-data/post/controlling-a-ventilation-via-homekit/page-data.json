{"componentChunkName":"component---node-modules-lekoarts-gatsby-theme-minimal-blog-core-src-templates-post-query-tsx","path":"/post/controlling-a-ventilation-via-homekit","result":{"data":{"post":{"__typename":"MdxPost","slug":"/post/controlling-a-ventilation-via-homekit","title":"Controlling a ventilation system via HomeKit","date":"2018-07-18","tags":null,"description":null,"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"layout\": \"post\",\n  \"slug\": \"/post/controlling-a-ventilation-via-homekit\",\n  \"title\": \"Controlling a ventilation system via HomeKit\",\n  \"summary\": \"How to setup a micro controller to control a ventilation system and integrate it with Apple HomeKit.\",\n  \"categories\": \"CC1101, ESP8266, HomeKit, Arduino, home automation\",\n  \"banner\": \"https://user-images.githubusercontent.com/133832/42869060-3f6a7818-8a74-11e8-8b89-f88419b3c90b.jpg\",\n  \"date\": \"2018-07-18T00:00:00.000Z\",\n  \"published\": true\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"I'm a software developer. Working on web applications is my passion. But I like to learn things and a few months ago I got inspired by my colleague \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://twitter.com/Ruud_\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }), \"Ruud\"), \" to dive into hardware. After some brainstorming I found a nice first project to try. This is a brain dump of what I did and my learnings \\u2013 I hope they inspire someone else.\"), mdx(\"h2\", null, \"Ventilation\"), mdx(\"p\", null, \"In our house, there is a ventilation system, an Itho CVE ECO RFT to be precise. Almost every room has a ventilation vent that looks like this:\"), mdx(\"div\", {\n    \"style\": {\n      \"maxWidth\": \"150px\"\n    }\n  }, mdx(\"span\", _extends({\n    parentName: \"div\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"960px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"101.66666666666666%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/svg+xml,%3csvg%20xmlns=\\\\'http://www.w3.org/2000/svg\\\\'%20width=\\\\'400\\\\'%20height=\\\\'407\\\\'%20viewBox=\\\\'0%200%20400%20407\\\\'%20preserveAspectRatio=\\\\'none\\\\'%3e%3cpath%20d=\\\\'M170%201A192%20192%200%20009%20132a216%20216%200%2000113%20255c31%2015%2059%2021%2095%2020a179%20179%200%2000159-96c18-34%2024-57%2024-104v-17%2011l-1-9a236%20236%200%2000-19-68C348%2059%20283%2010%20215%201h-45\\\\'%20fill=\\\\'%23d3d3d3\\\\'%20fill-rule=\\\\'evenodd\\\\'/%3e%3c/svg%3e')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/15dcc7df653ab8f936ba48191eabec03/cbea2/ventilation-itho.webp 240w\", \"/static/15dcc7df653ab8f936ba48191eabec03/42669/ventilation-itho.webp 480w\", \"/static/15dcc7df653ab8f936ba48191eabec03/10c02/ventilation-itho.webp 960w\", \"/static/15dcc7df653ab8f936ba48191eabec03/39b23/ventilation-itho.webp 1072w\"],\n    \"sizes\": \"(max-width: 960px) 100vw, 960px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/15dcc7df653ab8f936ba48191eabec03/5243c/ventilation-itho.png 240w\", \"/static/15dcc7df653ab8f936ba48191eabec03/ab158/ventilation-itho.png 480w\", \"/static/15dcc7df653ab8f936ba48191eabec03/7d769/ventilation-itho.png 960w\", \"/static/15dcc7df653ab8f936ba48191eabec03/78899/ventilation-itho.png 1072w\"],\n    \"sizes\": \"(max-width: 960px) 100vw, 960px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/15dcc7df653ab8f936ba48191eabec03/7d769/ventilation-itho.png\",\n    \"alt\": \"ventilation itho\",\n    \"title\": \"ventilation itho\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"We have 1 remote control in our bathroom to set different ventilation speeds or a 10 min timer. All vents are regulated centrally, you can't set the speed for each vent. It looks like this:\"), mdx(\"div\", {\n    \"style\": {\n      \"maxWidth\": \"150px\"\n    }\n  }, mdx(\"span\", _extends({\n    parentName: \"div\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"900px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"100%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/svg+xml,%3csvg%20xmlns=\\\\'http://www.w3.org/2000/svg\\\\'%20width=\\\\'400\\\\'%20height=\\\\'400\\\\'%20viewBox=\\\\'0%200%20400%20400\\\\'%20preserveAspectRatio=\\\\'none\\\\'%3e%3cpath%20d=\\\\'M324%2011a3799%203799%200%2001-170%2011%20644%20644%200%2001-48%203l-29%202c-20%201-24%202-29%206l-6%205c-7%205-9%2013-8%2038v52a3537%203537%200%20002%20144c1%200%202%207%202%2032a198%20198%200%2001-2%2044l-1%2012-1%204%201%204%201%205c0%204%200%206%202%208s2%204%201%204c-2%200%200%202%203%202l2%201c0%202-5%201-8-1l-4-2c0%201-1%201%206%205%2014%209%2015%209%2060%205a2080%202080%200%2001103-10l42-4%2046-5%2037-3c25-2%2033-5%2042-13%208-9%2010-14%2011-33l3-235V30l-3-5c-9-16-16-18-55-14m-9%2012A4952%204952%200%200093%2037c-42%203-45%204-49%2016-3%206-4%20140-2%20228%202%2087%202%2095%207%2095a76%2076%200%200023-11l4-4%202-1%204-2%204-3%202-1%205-4c5-4%206-5%206-7l-2-12a1291%201291%200%20014-241%209475%209475%200%200065-11%201392%201392%200%2001143-8l31%201%203-3%206-10%205-9%201-2%201-3%203-5h1l1-2%202-4c1-1%201-1-2-5-4-8-3-7-46-6m24%2055l-3%202-1%201h-2l-1%202%201%2021c6%2066%205%20136-3%20199-1%2010-2%2012-7%2013l-12%202c-50%2011-123%2017-182%2017h-20l-2%203-3%204-1%202v1l37%201a719%20719%200%2000191-20c8-2%209-4%2011-24l2-20%204-62a855%20855%200%2000-9-142m-133%2093l-2%2012-1%209-6%202-5%202c0%201%2015%202%2016%201%202-1%203-21%201-21l-1-3c0-3-1-3-2-2\\\\'%20fill=\\\\'%23d3d3d3\\\\'%20fill-rule=\\\\'evenodd\\\\'/%3e%3c/svg%3e')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/1fda08ddc499ae8f42604338f36020d7/cbea2/ventilation-itho-rft.webp 240w\", \"/static/1fda08ddc499ae8f42604338f36020d7/42669/ventilation-itho-rft.webp 480w\", \"/static/1fda08ddc499ae8f42604338f36020d7/5722e/ventilation-itho-rft.webp 900w\"],\n    \"sizes\": \"(max-width: 900px) 100vw, 900px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/1fda08ddc499ae8f42604338f36020d7/46946/ventilation-itho-rft.jpg 240w\", \"/static/1fda08ddc499ae8f42604338f36020d7/55489/ventilation-itho-rft.jpg 480w\", \"/static/1fda08ddc499ae8f42604338f36020d7/86440/ventilation-itho-rft.jpg 900w\"],\n    \"sizes\": \"(max-width: 900px) 100vw, 900px\",\n    \"type\": \"image/jpeg\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/1fda08ddc499ae8f42604338f36020d7/86440/ventilation-itho-rft.jpg\",\n    \"alt\": \"ventilation itho rft\",\n    \"title\": \"ventilation itho rft\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"I found it a bit annoying to walk to the bathroom when I'm laying in bed and notice that I forgot to turn the ventilation to a lower speed. Not really a huge deal of course, but I found this could be better and a nice project to experiment on. The goal was to use my phone to set the ventilation speed by integrating the ventilation with HomeKit:\"), mdx(\"div\", {\n    \"style\": {\n      \"maxWidth\": \"300px\"\n    }\n  }, mdx(\"span\", _extends({\n    parentName: \"div\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"750px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"177.91666666666669%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/svg+xml,%3csvg%20xmlns=\\\\'http://www.w3.org/2000/svg\\\\'%20width=\\\\'400\\\\'%20height=\\\\'711\\\\'%20viewBox=\\\\'0%200%20400%20711\\\\'%20preserveAspectRatio=\\\\'none\\\\'%3e%3cpath%20d=\\\\'M0%20356v355h401V0H0v356M194%2070c-21%206-21%2037-1%2043%205%201%204%203-1%204l-6%202%2014%201c12%200%2014%200%2013-1%200-2-2-2-5-2-6%200-7-2-1-4%209-3%2015-11%2015-21%200-15-14-26-28-22m-34%2069c-3%203-3%2010%200%2012%205%204%209%201%209-6s-5-11-9-6m93-1l-1%202c0%202-1%202-2%201-2%200-3%200-4%202-4%205-1%209%205%2010h4v-8c0-7-1-9-2-7m-44%204c-2%201-1%2014%201%2014l1-3c0-2%200-2%202-1%204%203%208-6%204-9-1-2-3-2-5-1h-3m-36%20105c-22%202-36%2015-38%2035a6449%206449%200%20001%20271c5%2015%2016%2025%2030%2028h68c11-2%2020-9%2025-18%206-11%206-11%207-83v-66h-15l7-1h7v-61c1-68%201-74-4-84-6-13-17-19-35-21h-53\\\\'%20fill=\\\\'%23d3d3d3\\\\'%20fill-rule=\\\\'evenodd\\\\'/%3e%3c/svg%3e')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/2d3af89024493d28a4e1ddc9d1fd0538/cbea2/ventilation-homekit.webp 240w\", \"/static/2d3af89024493d28a4e1ddc9d1fd0538/42669/ventilation-homekit.webp 480w\", \"/static/2d3af89024493d28a4e1ddc9d1fd0538/2ad20/ventilation-homekit.webp 750w\"],\n    \"sizes\": \"(max-width: 750px) 100vw, 750px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/2d3af89024493d28a4e1ddc9d1fd0538/5243c/ventilation-homekit.png 240w\", \"/static/2d3af89024493d28a4e1ddc9d1fd0538/ab158/ventilation-homekit.png 480w\", \"/static/2d3af89024493d28a4e1ddc9d1fd0538/44507/ventilation-homekit.png 750w\"],\n    \"sizes\": \"(max-width: 750px) 100vw, 750px\",\n    \"type\": \"image/png\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/2d3af89024493d28a4e1ddc9d1fd0538/44507/ventilation-homekit.png\",\n    \"alt\": \"ventilation homekit\",\n    \"title\": \"ventilation homekit\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"h2\", null, \"Remote Control\"), mdx(\"p\", null, \"The remote for the Itho CVE ECO RFT cost around 50-60 euro, which I found quite steep. I first thought I had to buy one and reverse engineer it. But I had the incredible luck that an awesome engineer already \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.progz.nl/homeautomation/2014/12/29/reverse-engineering-remote-itho-cve-eco-rft-part-1/\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }), \"reverse-engineered\"), \" the remote control. The biggest part of this whole project was already done! All that was left was to get hardware and integrate with HomeKit.\"), mdx(\"h2\", null, \"Hardware\"), mdx(\"p\", null, \"The place where I bought the hardware is \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.aliexpress.com/\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }), \"AliExpress\"), \". It felt a bit shady to buy there because the prices were low and there were no shipping costs. It worked out great though. I considered the environmental impact of buying in China. Most products are shipped from China, and except the price, there is not a difference to buying it in Europe \\u2013\\xA0so I went with it. Bring some patience, it takes a few weeks until you get your parts. Unfortunately, I didn't receive some parts as well.\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.aliexpress.com/item/MB102-Breadboard-power-module-MB-102-830-points-Solderless-Prototype-Bread-board-kit-65-Flexible-jumper/32690555189.html?spm=a2g0s.9042311.0.0.27424c4dprEHhP\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }), \"Breadboard\"), \" with jumper wires\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"For hoppy projects like this, you want a solderless breadboard. It's called breadboard because in the early days, people nailed copper wires in wooden boards to create electrical circuits \\u2013\\xA0sometimes boards that were actually used to slice bread on. Solderless means you don't have to deal with soldering. You just need to put the jumper cables into the right holes, and you're done.\"), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"A bread board often has numbers and letters on them. They can be used to rebuild electrical circuits from others. The holes are connected in a certain way. Read this \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.sciencebuddies.org/science-fair-projects/references/how-to-use-a-breadboard#holes\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }), \"great overview\"), \" to learn how the holes are connected.\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.aliexpress.com/item/1pc-E07-868MS10-CC1101-868MHz-SPI-Transceiver-rf-Module-CDSENET-Wireless-Receiver-868-MHz-for-Arduino/32800599482.html?spm=a2g0s.9042311.0.0.27424c4dprEHhP\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }), \"CC1101\"), mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"Chip manufacturers like to use acronyms and numbers to identify their products. A CC1101 is a radio transceiver, and it's needed to emulate the Itho CVE ECO RFT remote control. This means this chip can send and receive information via radio signals. It's actually quite amazing how this works \\u2013 in those chips are crystals that vibrate to create a certain electric frequency. This chip sends and receives on the 868 Mhz band, which the Itho uses.\")), mdx(\"li\", {\n    parentName: \"ol\"\n  }, mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.aliexpress.com/item/ESP8266-ESP-12-NodeMCU-Lua-WiFi-Internet-Things-Development-Board/32368848967.html?spm=a2g0s.9042311.0.0.27424c4ddIBWwT\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }), \"ESP8266\"), mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"To control the CC1101 chip, you need a microcontroller. The ESP8266 is cheaper than Arduinos and comes with a wifi-module, which is perfect to combing with Homekit. The \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.arduino.cc/en/Main/Software\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }), \"Arduino IDE\"), \" can be used to program this microcontroller in C/C++.\"))), mdx(\"h3\", null, \"How to get it running\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"1) Connect all the hardware\")), mdx(\"div\", {\n    \"style\": {\n      \"maxWidth\": \"800px\"\n    }\n  }, mdx(\"span\", _extends({\n    parentName: \"div\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"960px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"52.083333333333336%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/svg+xml,%3csvg%20xmlns=\\\\'http://www.w3.org/2000/svg\\\\'%20width=\\\\'400\\\\'%20height=\\\\'209\\\\'%20viewBox=\\\\'0%200%20400%20209\\\\'%20preserveAspectRatio=\\\\'none\\\\'%3e%3cpath%20d=\\\\'M120%206c30%208%2039%2011%2039%2012l-4%203-7%204c-2%202-4%203-5%202v1c1%201-2%205-7%2011-5%205-10%2023-10%2031v11l1%201c1-1%204%201%208%204l7%204c1%200%202%200%201%201h-1l-1%202%201%201%201%201h3l1-2v2l2%201%201%204c-1%202-1%203%201%203l1-3v-2c2%200%203%203%203%205-1%203%203%202%204-1s1-3%203-2c1%202%203%202%205%201h1l2%202a354%20354%200%20017-26l-2%203c1%201%200%201-3%201-2%200-3-1-3-2%200-4%201-5%204-5s3%200%202-2l-1-1%203%202c1%202%202%202%202-2l1-9-4%201-7%203-6%202-4%201-4%202c-4%202-11%2011-8%2013%202%201%201%202-1%202l-2-1-4-4-6-5c0-2-1-3-2-3-1%201-3-4-3-7%202-9%204-16%206-17l1-2c0-4%2017-23%2020-21h1c-1-3%203-5%205-3s3%201%202-1c0-2%200-2%201-1%202%201%202%201%202-1%201-2%204-3%204-1h7c9-5%2046-7%2060-4l16%207c0%201-1%201-6-1a120%20120%200%2000-88%208l-2%202c0-1-2%200-3%202-5%205-11%2016-12%2024l-2%208c-2%201-2%203-1%203%202%200%205-5%206-11%201-9%209-21%2013-23l2-2%203-3c3%200%200%205-5%2010-7%206-10%2012-10%2018%200%205%203%206%204%200l1-3v-2l2-4%202-2-1%203v9l4-2c3-1%203-2%202-2l-2-2c0-4%204-13%206-13l6-3a35%2035%200%200111-5l-2%203-5%203-1%201-2%203c-3%201-4%204-3%208%200%203%200%203%203%203%203-1%205-4%205-9l2-3%202-2c0-1%206-5%2013-7%202-2%204-1%2024%205l28%207c26%203%2036%207%2041%2015%203%205%204%208%202%208v1l1%201c2-1%203%204%202%206-2%202-4%201-4-1s0-2-2-2c-2%201-2%200-2-3%201-5-2-7-3-2%200%202-1%203-2%203-2%200-2%200-2-5%201-9-1-9-3-1%200%203-1%205-2%205-3%200-3-3-1-8v-5c-1-2-3%200-4%204-2%209-7%207-7-3%200-4-1-6-2-6-2%200-2%201-1%206l-1%206c-2%200-2%200-1%201v3l-1%204c0%203%200%204-3%207l-3%203v-2c0-3-3-4-3-1h-1l-2-3h-3l-1%201h-1l-1-1c0-2-1-2-3-2l-3-2h-4l-1%201-1-2c0-1-2-2-7-3h-2c4%204%202%208-2%206-3%200-3-1-3-3l1-2-2%202-2%202c-2%200-2%200-1%201s1%201-1%203l-1%203-1%203c-1%200-2%201-1%203l-1%203c-1%200-2%201-2%203s1%203%203%204l5%201h2l-4-2-4-3c0-2%202-3%205-1l4%201-3-2-4-3%204-8-1%203c-2%205-1%206%203%207l4%203c-1%202-3%202-8%201l2%201c6%203%204%206-4%204-3-1-2%200%201%201%206%203%206%203%204%204-1%202-3%202-8-1l-2%201%2012%204%203-8%204-6c0%201-4%2014-6%2016%200%201-13-4-15-6-1-1-3%201-3%206%200%201%200%202-1%201l-1%202c1%201%200%203-1%203-2%203%201%2011%205%2011%202%200%207%205%207%207-1%203%201%205%202%203%202-2%204-1%203%201l3%201c3-1%203-1%204%201%200%202%202%203%204%200h1c0%203%203%205%204%203%202-2%203-2%203%201%200%201%201%202%203%202l2-1v-1l1%207c0%202%200%202%201%201%200-2%204-5%205-5l1%201%201%202h5c-1%202%203%204%204%202%200-1%201-1%202%201%202%202%202%202%204%201%203-1%203-1%203%201l3%201%203%201c0%202%205%203%206%202s1-1%201%201%200%202%203%202h3c-1%201%201%202%204%202l3%202c1%201%204%202%2010%202%208%200%208%200%206-2-1-2-1-2%201-2l3%201-2%209c-7%2026-10%2034-14%2032h-1a369%20369%200%2000-41-15l-7-3v-1h-4c-2%200-2%200-1-1s0-1-1-1h-3l-5-1-9-3a154%20154%200%2001-17-7l-15-5A9971%209971%200%20001%20101l-1%2054v54h401l-1-89V0H99l21%206m176%2055l3%209%202%205h2c1%201%202%206%200%206l-1%207c1%205%201%206%203%205l2%201c2%202%205%203%205%202h2l1%201%203%201h4c2%200%203-1%204-6l3-9%202-8%201-6-16-4-17-6c-4-2-5-1-3%202m-75%2019c-2%204-2%205%201%205l-1%207c-7%2018-7%2018-3%2018l3%201%208%202%207%202%2017%206%202-6%203-7%201-2v-1l1-2%201-5c2-3%201-5-1-2-1%201-1%201-1-1l-1-2h-1l-4%201c-3%200-4%200-3-1%203%200%203-4%201-4l-2-2-1-1h-1l-1%201-1-1-1-2c-1-1-2%200-2%201h-2l-1-1-1-1h-1l-1%201-1-1-1-2h-2l-1%201-1-1c0-2-2-3-4-1h-1c0-3-3-3-4%200m94%2039c-3%202-4%204-2%204s4%204%203%205l-2-1h-2v1c1%200%202%201%201%202l1%201%201%201h-2l-1%202c1%201%2013%206%2015%205l5-16-7-3c-8-3-8-3-10-1\\\\'%20fill=\\\\'%23d3d3d3\\\\'%20fill-rule=\\\\'evenodd\\\\'/%3e%3c/svg%3e')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/25d28baca75c0c914b13f8ddd478992a/cbea2/ventilation-esp.webp 240w\", \"/static/25d28baca75c0c914b13f8ddd478992a/42669/ventilation-esp.webp 480w\", \"/static/25d28baca75c0c914b13f8ddd478992a/10c02/ventilation-esp.webp 960w\", \"/static/25d28baca75c0c914b13f8ddd478992a/fead5/ventilation-esp.webp 1440w\", \"/static/25d28baca75c0c914b13f8ddd478992a/485a2/ventilation-esp.webp 1600w\"],\n    \"sizes\": \"(max-width: 960px) 100vw, 960px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/25d28baca75c0c914b13f8ddd478992a/46946/ventilation-esp.jpg 240w\", \"/static/25d28baca75c0c914b13f8ddd478992a/55489/ventilation-esp.jpg 480w\", \"/static/25d28baca75c0c914b13f8ddd478992a/18e3b/ventilation-esp.jpg 960w\", \"/static/25d28baca75c0c914b13f8ddd478992a/60e21/ventilation-esp.jpg 1440w\", \"/static/25d28baca75c0c914b13f8ddd478992a/b46c2/ventilation-esp.jpg 1600w\"],\n    \"sizes\": \"(max-width: 960px) 100vw, 960px\",\n    \"type\": \"image/jpeg\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/25d28baca75c0c914b13f8ddd478992a/18e3b/ventilation-esp.jpg\",\n    \"alt\": \"ventilation esp\",\n    \"title\": \"ventilation esp\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \")), mdx(\"p\", null, \"This is the end result. You can also see a \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/adri/IthoEcoFanRFT\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }), \"table of the connections\"), \". For the power supply I connected the ESP8266 via USB to a Mac mini.\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"2) ESP8266 with REST interface\")), mdx(\"p\", null, \"To get started with programming the ESP, I recommend the following steps:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://www.arduino.cc/en/Main/Software\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }), \"Get the Arduino IDE\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://www.silabs.com/products/development-tools/software/usb-to-uart-bridge-vcp-drivers\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }), \"Get the serial UART interface\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://www.youtube.com/watch?v=G6CqvhXpBKM\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }), \"Follow the Arduino IDE video\"))), mdx(\"p\", null, \"I was lucky to be able to reuse a lot of code. All I added was a REST interface and connect to a local wifi. You can use the code from my \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/adri/IthoEcoFanRFT\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }), \"fork\"), \". To connect the ESP to your wifi network, add the wifi credentials in \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/adri/IthoEcoFanRFT/blob/master/IthoEcoFanRFT.ino#L35-L36\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }), mdx(\"inlineCode\", {\n    parentName: \"a\"\n  }, \"IthoEcoFanRFT.ino\")), \". To get the code running on the ESP, open the \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"IthoEcoFanRFT.ino\"), \" file in the Arduino IDE and upload it like explained \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.youtube.com/watch?v=m2fEXhl70OY\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }), \"in this video\"), \". You should see an IP popping up in the serial monitor. Test that it works by opening \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http://[ip]/\"), \" in a browser. The ventilation doesn't react yet, it needs to be paired with the new remote.\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"3) Pair the ESP as a remote\")), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Plug out the Itho CVE ECO RFT ventilation unit\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Wait at least 15 seconds\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Plug in the ventilation unit\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"Upload the code from the previous step within 2 minutes\")), mdx(\"p\", null, \"Test that it works by opening \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http://[ip]/press?button=high\"), \" and \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"http://[ip]/press?button=low\"), \" in a browser. You should hear the ventilation picking up speed and slowing down again.\"), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"4) HomeKit support\")), mdx(\"p\", null, \"I wrote \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/adri/homebridge-itho-cve-eco-rft\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }), \"a Homebridge plugin\"), \" to control the ESP. \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/nfarina/homebridge\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }), \"Homebridge\"), \" emulates the iOS HomeKit API and is written in NodeJS. You can use the IP from the last step in the installation step \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/adri/homebridge-itho-cve-eco-rft\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }), \"described here\"), \". The challenge here was to map the actions coming from HomeKit to signals going to the remote. I ended up using a \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/adri/homebridge-itho-cve-eco-rft/blob/master/index.js#L105-L121\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }), \"state machine\"), \" which worked great.\", mdx(\"br\", {\n    parentName: \"p\"\n  }), \"\\n\", \"There is now also \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/maximkulkin/esp-homekit\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }), \"esp-homekit\"), \", an option to emulate the HomeKit API directly on the ESP, which I didn't try yet.\"), mdx(\"h2\", null, \"Learnings\"), mdx(\"p\", null, \"Doing things with hardware is much more accessible than I thought. A wealth of information and libraries are available online. It's fun for once to program something that is a bit more real than just software. I also learned that the hardware doesn't cost much. A few Euro spent on a microcontroller already open up so many possibilities. There is a nice \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.youtube.com/watch?v=UoBUXOOdLXY\",\n    \"target\": \"_blank\",\n    \"rel\": \"nofollow noopener noreferrer\"\n  }), \"TED talk\"), \" showing examples of creative ideas that come to life using microcontrollers.\"), mdx(\"p\", null, \"Are you building something cool? Let me know in the comments :)\"));\n}\n;\nMDXContent.isMDXComponent = true;","excerpt":"I'm a software developer. Working on web applications is my passion. But I like to learn things and a few months ago I got inspired by my…","timeToRead":4,"banner":null}},"pageContext":{"slug":"/post/controlling-a-ventilation-via-homekit","formatString":"YYYY-MM-DD"}},"staticQueryHashes":["318001574","3787687951","3787687951"]}